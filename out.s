; Simple example shellcode for 32-bit ARM
;
; Writes an example string to standard out.
; Useful for demonstrating that arbitrary code
; execution is possible.

.section .text
.global _start

_start:
	; _write(fd, buf, size)
	mov	r0, $0x1	; stdout 
	mov	r1, pc
	add	r1, #24		; distance from code to string
	mov	r2, #8		; length of string
	mov	r7, $0x4	; syscall number
	svc	0		; interrupt

	; _exit(int)
	sub	r0, r0, r0	; exit code 0
	mov	r7, $0x1	; syscall number
	svc	0		; interrupt

.ascii "Hacked.\n"
